# state ì ìš©

```jsx
import { useState } from "react";

function App() {
  const [counter, setValue] = useState(0);
  const onClick = () => {
    setValue((prev) => prev + 1);
  };
  return (
    <div>
      <h1>{counter}</h1>
      <button onClick={onClick}>click me</button>
    </div>
  );
}

export default App;
```

create-react-appì„ ì‚¬ìš©í•˜ê³  ìˆê¸° ë•Œë¬¸ì— useStateë§Œ ì‘ì„±í•´ë„ ìë™ìœ¼ë¡œ importë¥¼ í•´ì¤Œ

counterë¥¼ ë§Œë“¤ê³  ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ counterê°€ ì¦ê°€í•˜ëŠ” ë¡œì§ì„ ì‘ì„±



```jsx
function App() {
  const [counter, setValue] = useState(0);
  const onClick = () => {
    setValue((prev) => prev + 1);
  };
  console.log("render");
  return (
    <div>
      <h1>{counter}</h1>
      <button onClick={onClick}>click me</button>
    </div>
  );
}
```

ì¤‘ê°„ì— renderê°€ ë  ë•Œë§ˆë‹¤ ì½˜ì†” ë¡œê·¸ì— renderë¥¼ ì¶œë ¥í•´ë³´ì



## ğŸš¨ StrictMode

```jsx
import React from "react";
import ReactDOM from "react-dom/client";
import App from "./App";

const root = ReactDOM.createRoot(document.getElementById("root"));
root.render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);
```

ê¸°ë³¸ create-react-appìœ¼ë¡œ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•˜ë©´ index.jsì— React.StrictModeë¡œ Appì´ ê°ì‹¸ì ¸ ìˆìŒ

https://ko.legacy.reactjs.org/docs/strict-mode.html

StrictModeëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ì˜ ì ì¬ì ì¸ ë¬¸ì œë¥¼ ì•Œì•„ë‚´ê¸° ìœ„í•œ ë„êµ¬ì´ë©° ìì†ë“¤ì— ëŒ€í•œ ë¶€ê°€ì ì¸ ê²€ì‚¬ì™€ ê²½ê³ ë¥¼ í™œì„±í™”í•¨

ê·¸ë ‡ê¸° ë•Œë¬¸ì— renderê°€ ë‘ ë²ˆ ì¶œë ¥ë¨

![image-20230426192453835](8.effects.assets/image-20230426192453835.png)

StrictMode íƒœê·¸ë¥¼ ì œê±°í•˜ë©´ ì •ìƒì ìœ¼ë¡œ renderê°€ í•œ ë²ˆì”© ì¶œë ¥ë¨

![image-20230426192711327](8.effects.assets/image-20230426192711327.png)



ë¡œê·¸ëŠ” stateê°€ ë³€í•  ë•Œ, ì¦‰ counterê°€ ë³€í•  ë•Œë§ˆë‹¤ ê³„ì†í•´ì„œ ì¶œë ¥ë¨

í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” ì²˜ìŒ ë Œë”ë§í–ˆì„ ë•Œ í•œ ë²ˆë§Œ ì‹¤í–‰í•˜ê³  stateê°€ ë³€í•´ë„ ì‹¤í–‰ì´ ë˜ì§€ ì•Šê²Œ í•˜ê³  ì‹¶ìŒ

ì˜ˆë¥¼ ë“¤ë©´, APIë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ê°€ì ¸ì™”ì„ ë•Œ ë°ì´í„°ê°€ ìˆ˜ì •ë˜ë©´ ë‹¤ì‹œ APIë¥¼ í˜¸ì¶œí•´ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒì´ ì•ˆë˜ê²Œ í•˜ê³  ì‹¶ìŒ



# useEffect

ì»´í¬ë„ŒíŠ¸ê°€ ì²˜ìŒ ë Œë”ë§ë  ë•Œ ë”± í•œ ë²ˆë§Œ ì‹¤í–‰í•˜ê¸° ìœ„í•´ì„œ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜



useEffectëŠ” ë‘ ê°œì˜ ì¸ì(argument)ë¥¼ ê°€ì§

ì²« ë²ˆì§¸ ì¸ìëŠ” ë”± í•œ ë²ˆë§Œ ì‹¤í–‰í•  ì½”ë“œ

```jsx
import { useState, useEffect } from "react";

function App() {
  const [counter, setValue] = useState(0);
  const onClick = () => {
    setValue((prev) => prev + 1);
  };
  console.log("i run all the time");
  const iRunOnlyOnce = () => {
    console.log("i run only once");
  };
  useEffect(iRunOnlyOnce, []);
  return (
    <div>
      <h1>{counter}</h1>
      <button onClick={onClick}>click me</button>
    </div>
  );
}

export default App;
```

useEffectë¥¼ importí•˜ê³ 

useEffect ì•ˆì— ì²« ë²ˆì§¸ ì¸ìë¡œ í•œ ë²ˆë§Œ ì‹¤í–‰í•  í•¨ìˆ˜ë¥¼ ë‘ ë²ˆì§¸ ì¸ìë¡œ ë¹ˆ ë°°ì—´ì„ ì‘ì„±í•´ì¤Œ

![image-20230426193400155](8.effects.assets/image-20230426193400155.png)

ë²„íŠ¼ì„ í´ë¦­í•´ë„ useEffect ì•ˆì— ìˆëŠ” í•¨ìˆ˜ëŠ” í•œ ë²ˆë§Œ ì‹¤í–‰ë˜ê³  ë‹¤ì‹œ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ



```jsx
function App() {
  const [counter, setValue] = useState(0);
  const onClick = () => {
    setValue((prev) => prev + 1);
  };
  console.log("i run all the time");
  useEffect(() => {
    console.log("CALL THE API...");
  }, []);
  return (
    <div>
      <h1>{counter}</h1>
      <button onClick={onClick}>click me</button>
    </div>
  );
}
```

ìœ„ì™€ ê°™ì´ í™”ì‚´í‘œ í•¨ìˆ˜ë¡œ ì¶•ì•½í•  ìˆ˜ ìˆìŒ



> useEffect functionì€ ì‰½ê²Œ ë§í•´ì„œ ìš°ë¦¬ ì½”ë“œê°€ ë”± í•œ ë²ˆë§Œ ì‹¤í–‰ë  ìˆ˜ ìˆë„ë¡ ë³´í˜¸í•´ì¤Œ



## Memo vs. useEffect

MemoëŠ” propsê°€ ë³€ê²½ë˜ì§€ ì•Šì•˜ë‹¤ë©´ ì»´í¬ë„ŒíŠ¸ë¥¼ ë¦¬ë Œë”ë§í•˜ì§€ ì•Šë„ë¡ í•´ì£¼ëŠ” ê²ƒ

useEffectëŠ” propsê°€ ë³€ê²½ë˜ê±°ë‚˜ ì»´í¬ë„ŒíŠ¸ì˜ ìƒëª…ì£¼ê¸°ì˜ ì²˜ìŒê³¼ ë§ˆì§€ë§‰ì— í•œ ë²ˆ ì‹¤í–‰í•˜ëŠ” í•¨ìˆ˜



## useEffect ë‘ ë²ˆì§¸ ì¸ì

> dependencies, react.jsê°€ ì§€ì¼œë³´ì•„ì•¼ í•˜ëŠ” ê²ƒë“¤
>
> ê·¸ê²ƒë“¤ì´ ë³€í•  ë•Œ, react.jsê°€ ì½”ë“œë¥¼ ì‹¤í–‰ì‹œí‚´

```jsx
import { useState, useEffect } from "react";

function App() {
  const [counter, setValue] = useState(0);
  const [keyword, setKeyword] = useState("");
  const onClick = () => {
    setValue((prev) => prev + 1);
  };
  const onChange = (event) => {
    setKeyword(event.target.value);
  };
  console.log("i run all the time");
  useEffect(() => {
    console.log("CALL THE API...");
  }, []);
  console.log("SEARCH FOR", keyword);
  return (
    <div>
      <input
        value={keyword}
        onChange={onChange}
        type="text"
        placeholder="Search here..."
      />
      <h1>{counter}</h1>
      <button onClick={onClick}>click me</button>
    </div>
  );
}

export default App;
```

ê²€ìƒ‰ì„ ìœ„í•´ input íƒœê·¸ë¥¼ ì‘ì„±í•˜ê³  valueë¡œ keyword stateë¥¼ ì—°ê²°

value ê°’ì´ ë³€ê²½ë  ë•Œë§ˆë‹¤ onChange í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ keywordì˜ ê°’ì„ event.target.valueë¡œ ë°”ê¿”ì¤Œ

![image-20230426221839983](8.effects.assets/image-20230426221839983.png)

í•˜ì§€ë§Œ ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ console.log(SEARCH FOR, keyword)ê°€ í˜¸ì¶œë¨

ì´ ì½”ë“œëŠ” keywordê°€ ë³€ê²½ë  ë•Œë§Œ ì‹¤í–‰ì‹œí‚¤ê³  ì‹¶ìŒ(counterê°€ ë³€í•˜ë”ë¼ë„ ì‹¤í–‰í•˜ì§€ ì•ŠìŒ)



íŠ¹ì • ë¶€ë¶„ì´ ë³€ê²½ë˜ì—ˆì„ ë•Œë§Œ ì›í•˜ëŠ” ì½”ë“œë“¤ì„ ì‹¤í–‰í•˜ëŠ” ë°©ë²•ì„ ì¨ì•¼ í•¨

keyword stateê°€ ë³€í–ˆì„ ë•Œë§Œ ì‹¤í–‰

```jsx
useEffect(() => {
  console.log("SEARCH FOR", keyword);
}, [keyword]);
```

keywordê°€ ë³€í–ˆì„ ë•Œë§Œ ì‹¤í–‰

ë§Œì•½ ë¹ˆ ë°°ì—´ì´ë¼ë©´ ì§€ì¼œë³¼ ê²ƒì´ ì—†ê¸° ë•Œë¬¸ì— í•œ ë²ˆë§Œ ì‹¤í–‰í•˜ëŠ” ê²ƒ



í•˜ì§€ë§Œ ì²˜ìŒ ì‹œì‘í•  ë•Œë„ ì‹¤í–‰ë¨

```jsx
useEffect(() => {
  if (keyword !== "" && keyword.length > 5) {
    console.log("SEARCH FOR", keyword);
  }
}, [keyword]);
```

ì¡°ê±´ë¬¸ì„ ì‚¬ìš©í•˜ì—¬ ê¸¸ì´ê°€ 5ë³´ë‹¤ ê¸¸ ë•Œë§Œ ì‹¤í–‰



ì´ë¥¼ í†µí•´ì„œ ì–¸ì œ ì½”ë“œê°€ ì‹¤í–‰ë ì§€ ê²°ì •í•˜ëŠ” ë°©ë²•ì„ í•™ìŠµ

```jsx
useEffect(() => {
  console.log("I run only once");
}, []);
useEffect(() => {
  console.log("I run when 'keyword' changes");
}, [keyword]);
useEffect(() => {
  console.log("I run when 'counter' changes");
}, [counter]);
```

ë¹ˆ ë°°ì—´ì˜ ê²½ìš° ì»´í¬ë„ŒíŠ¸ ìƒì„±ì‹œ ì²˜ìŒ í•œ ë²ˆë§Œ ì‹¤í–‰

ë‘ ë²ˆì§¸ ì¸ìì— state ê°’ì„ ë„£ìœ¼ë©´ stateê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ ì‹¤í–‰



```jsx
useEffect(() => {
  console.log("I run when 'keyword' & 'counter' changes");
}, [keyword, counter]);
```

ì—¬ëŸ¬ ê°œì˜ stateë¥¼ ì‚¬ìš© ê°€ëŠ¥í•˜ê³  í•˜ë‚˜ì˜ stateê°€ ë³€í•˜ë©´ ì½”ë“œ ì‹¤í–‰



## component destroy

> componentê°€ íŒŒê´´ë  ë•Œ ì‹¤í–‰í•˜ëŠ” í•¨ìˆ˜ë¥¼ Cleanup functionì´ë¼ê³  í•¨
>
> ì˜ˆë¥¼ ë“¤ì–´, componentê°€ ì—†ì–´ì§ˆ ë•Œ ì–´ë–¤ ë¶„ì„ ê²°ê³¼ë¥¼ ë³´ë‚´ëŠ” ê²½ìš°, event listenerë¥¼ ì§€ìš°ê±°ë‚˜ console.logì— ë­”ê°€ë¥¼ ë³´ì—¬ì£¼ëŠ” ê²½ìš°



```jsx
function Hello() {
  function byeFn() {
    console.log("bye :(");
  }
  function hiFn() {
    console.log("hi :)");
    return byeFn;
  }

  useEffect(hiFn, []);

  return <h1>Hello</h1>;
}
```

react.jsê°€ ì§€ì¼œë³¼ dependencyê°€ ì—†ê¸° ë•Œë¬¸ì— componentê°€ ìƒì„±ë  ë•Œ í•œ ë²ˆ ì‹¤í–‰

componentê°€ íŒŒê´´ë  ë•Œ functionì„ ì‹¤í–‰í•˜ê³  ì‹¶ë‹¤ë©´ hiFnì˜ returnì— functionì„ ì‘ì„±



### ë‹¤ì–‘í•œ ì‚¬ìš©ë²•

```jsx
function Hello() {
  // 1. í•¨ìˆ˜ë¥¼ ë‘ ê°œ ë”°ë¡œ ì‘ì„±í•´ì„œ ì‚¬ìš©
  function byeFn() {
    console.log("bye :(");
  }
  function hiFn() {
    console.log("hi :)");
    return byeFn;
  }
    
  useEffect(hiFn, []);
    
  // 2. ì¼ë°˜ í•¨ìˆ˜ ì‚¬ìš©
  useEffect(function () {
    console.log("hi :)");
    return function () {
      console.log("bye :(");
    };
  }, []);

  // 3. í™”ì‚´í‘œ í•¨ìˆ˜ ì‚¬ìš©
  useEffect(() => {
    console.log("hi :)");
    return () => {
      console.log("bye :(");
    };
  }, []);

  return <h1>Hello</h1>;
}
```

